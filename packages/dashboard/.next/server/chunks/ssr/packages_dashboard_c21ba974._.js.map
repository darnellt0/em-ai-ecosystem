{"version":3,"sources":["../../../../../../packages/dashboard/lib/apiClient.ts","../../../../../../packages/dashboard/app/tools/actions/page.tsx"],"sourcesContent":["const RAW_API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:4000';\n\nexport const API_BASE = RAW_API_BASE.replace(/\\/$/, '');\n\nexport async function fetchJson<T>(path: string, init?: RequestInit): Promise<T> {\n  const res = await fetch(`${API_BASE}${path}`, {\n    ...init,\n    headers: {\n      'Content-Type': 'application/json',\n      ...(init?.headers || {}),\n    },\n    cache: 'no-store',\n  });\n\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(`Request failed (${res.status}) ${text}`);\n  }\n\n  return res.json();\n}\n","'use client';\n\nimport { useEffect, useState } from 'react';\n\nimport { API_BASE } from '@/lib/apiClient';\n\ninterface ActionItem {\n  id: string;\n  type: string;\n  status: string;\n  requiresApproval: boolean;\n}\n\nexport default function ActionsToolPage() {\n  const [actions, setActions] = useState<ActionItem[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState<string | null>(null);\n\n  const fetchActions = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(`${API_BASE}/api/actions/pending`);\n      const json = await res.json();\n      setActions(json.actions || []);\n    } catch (err: any) {\n      setMessage(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchActions();\n  }, []);\n\n  const approve = async (id: string) => {\n    setMessage(null);\n    await fetch(`${API_BASE}/api/actions/${id}/approve`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ approvedBy: 'operator' }),\n    });\n    fetchActions();\n  };\n\n  const execute = async (id: string, mode: 'PLAN' | 'EXECUTE') => {\n    setMessage(null);\n    const res = await fetch(`${API_BASE}/api/actions/${id}/execute`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ mode }),\n    });\n    const json = await res.json();\n    setMessage(`Receipt: ${json.receipt?.status || 'unknown'}`);\n    fetchActions();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 p-6 space-y-4\">\n      <h1 className=\"text-2xl font-semibold\">Action Console</h1>\n      <p className=\"text-sm text-slate-600\">Approve and execute planned actions. EXECUTE is gated by feature flags.</p>\n      <div className=\"bg-white rounded-lg shadow p-4\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <h2 className=\"font-semibold\">Pending Actions</h2>\n          <button className=\"px-3 py-1 text-sm bg-slate-800 text-white rounded\" onClick={fetchActions} disabled={loading}>\n            Refresh\n          </button>\n        </div>\n        {loading && <p className=\"text-sm text-slate-500\">Loading...</p>}\n        {!loading && actions.length === 0 && <p className=\"text-sm text-slate-500\">No pending actions.</p>}\n        <ul className=\"divide-y divide-slate-200\">\n          {actions.map((a) => (\n            <li key={a.id} className=\"py-3\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"font-medium\">{a.type}</p>\n                  <p className=\"text-xs text-slate-500\">ID: {a.id}</p>\n                  <p className=\"text-xs text-slate-500\">Status: {a.status}</p>\n                  {a.requiresApproval && <p className=\"text-xs text-amber-600\">Requires approval</p>}\n                </div>\n                <div className=\"space-x-2\">\n                  {a.requiresApproval && (\n                    <button className=\"px-3 py-1 text-xs bg-amber-500 text-white rounded\" onClick={() => approve(a.id)}>\n                      Approve\n                    </button>\n                  )}\n                  <button className=\"px-3 py-1 text-xs bg-slate-700 text-white rounded\" onClick={() => execute(a.id, 'PLAN')}>\n                    Execute (PLAN)\n                  </button>\n                  <button className=\"px-3 py-1 text-xs bg-slate-300 text-slate-800 rounded\" disabled>\n                    Execute (EXECUTE)\n                  </button>\n                </div>\n              </div>\n            </li>\n          ))}\n        </ul>\n      </div>\n      {message && <div className=\"text-sm text-slate-700\"> {message} </div>}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}