{"version":3,"sources":["../../../../../../packages/dashboard/app/tools/content-pipeline/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || \"\";\n\nasync function fetchJson(path: string, opts?: RequestInit) {\n  const res = await fetch(`${API_BASE}${path}`, {\n    ...opts,\n    headers: { \"Content-Type\": \"application/json\", ...(opts?.headers || {}) },\n  });\n  if (!res.ok) throw new Error(`Request failed: ${res.status}`);\n  return res.json();\n}\n\nexport default function ContentPipelinePage() {\n  const [userId, setUserId] = useState(\"darnell\");\n  const [topic, setTopic] = useState(\"Elevated Movements strengths story\");\n  const [includeP0, setIncludeP0] = useState(true);\n  const [packs, setPacks] = useState<any[]>([]);\n  const [selected, setSelected] = useState<any | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadList = async () => {\n    try {\n      setError(null);\n      const data = await fetchJson(\"/api/content/packs\");\n      setPacks(data.packs || []);\n    } catch (e: any) {\n      setError(e.message);\n    }\n  };\n\n  useEffect(() => {\n    loadList();\n  }, []);\n\n  const generate = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const body = { userId, topic, includeP0 };\n      await fetchJson(\"/api/content/packs/generate\", { method: \"POST\", body: JSON.stringify(body) });\n      await loadList();\n    } catch (e: any) {\n      setError(e.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const viewPack = async (packId: string) => {\n    try {\n      const data = await fetchJson(`/api/content/packs/${packId}`);\n      setSelected(data.pack);\n    } catch (e: any) {\n      setError(e.message);\n    }\n  };\n\n  const download = () => {\n    if (!selected) return;\n    const blob = new Blob([JSON.stringify(selected, null, 2)], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `${selected.packId}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <main className=\"p-6 space-y-6\">\n      <h1 className=\"text-2xl font-semibold\">Content Pipeline (PLAN-only)</h1>\n      {error && <div className=\"text-red-600\">{error}</div>}\n\n      <section className=\"space-y-3 border p-4 rounded-md\">\n        <h2 className=\"font-semibold\">Generate Pack</h2>\n        <div className=\"flex flex-col gap-2\">\n          <input className=\"border p-2\" value={userId} onChange={(e) => setUserId(e.target.value)} placeholder=\"userId\" />\n          <input className=\"border p-2\" value={topic} onChange={(e) => setTopic(e.target.value)} placeholder=\"topic\" />\n          <label className=\"flex items-center gap-2\">\n            <input type=\"checkbox\" checked={includeP0} onChange={(e) => setIncludeP0(e.target.checked)} />\n            Include P0 Daily Focus\n          </label>\n          <button className=\"bg-blue-600 text-white px-3 py-2 rounded\" onClick={generate} disabled={loading}>\n            {loading ? \"Generating...\" : \"Generate Pack\"}\n          </button>\n        </div>\n      </section>\n\n      <section className=\"space-y-3 border p-4 rounded-md\">\n        <h2 className=\"font-semibold\">Existing Packs</h2>\n        <button className=\"underline text-blue-600\" onClick={loadList}>\n          Refresh\n        </button>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full text-sm\">\n            <thead>\n              <tr>\n                <th className=\"text-left\">PackId</th>\n                <th className=\"text-left\">Created</th>\n                <th className=\"text-left\">Topic</th>\n                <th className=\"text-left\">Status</th>\n              </tr>\n            </thead>\n            <tbody>\n              {packs.map((p) => (\n                <tr key={p.packId} className=\"hover:bg-gray-100 cursor-pointer\" onClick={() => viewPack(p.packId)}>\n                  <td>{p.packId}</td>\n                  <td>{p.createdAt}</td>\n                  <td>{p.topic}</td>\n                  <td>{p.status}</td>\n                </tr>\n              ))}\n              {packs.length === 0 && (\n                <tr>\n                  <td colSpan={4} className=\"text-gray-500\">\n                    No packs yet.\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </section>\n\n      {selected && (\n        <section className=\"space-y-3 border p-4 rounded-md\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"font-semibold\">Pack Detail: {selected.packId}</h2>\n            <button className=\"underline\" onClick={download}>\n              Download JSON\n            </button>\n          </div>\n          <div className=\"text-sm\">Topic: {selected.topic}</div>\n          <div className=\"text-sm\">Status: {selected.status}</div>\n          <div className=\"text-sm\">Planned Actions: {selected.plannedActionIds?.length || 0}</div>\n          <div className=\"space-y-2\">\n            <h3 className=\"font-semibold\">Assets</h3>\n            {selected.assets?.map((a: any) => (\n              <div key={a.id} className=\"border p-2 rounded\">\n                <div className=\"text-xs uppercase text-gray-500\">{a.channel}</div>\n                <div className=\"font-semibold\">{a.title}</div>\n                <pre className=\"whitespace-pre-wrap text-xs\">{a.body}</pre>\n              </div>\n            ))}\n          </div>\n        </section>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}